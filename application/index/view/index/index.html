<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>ğŸˆå“ˆä¹æ²ƒå¾·äº”å‘¨å¹´ğŸˆ</title>
{include file="../application/index/view/common/header.html" /}
<link rel="stylesheet" href="/static/index/css/app1.css">
<link rel="stylesheet" href="/static/index/css/swiper.min.css">
<style>
  .el-upload-list--picture-card .el-upload-list__item,.el-upload--picture-card{width:30%;height:100px;line-height: 100px;}
  .imagelook .el-dialog{background-color:rgba(0,0,0,1)}
  .views_show{display:none;}
</style>
<!--[if IE]>
  <script>window.location.href = '/compatibility';</script>
  <![endif]-->
</head>
<body class="mdui-loaded">
<div id="app">
	<div class="header">
		<div class="header-banner" id="slides">
			  <div class="pike">
				<div style="height:160px;"><img class="image" src="http://cnf.mideoshow.com/uploads/banner1.jpg" /></div>
				<div style="height:160px;"><img class="image" src="http://cnf.mideoshow.com/uploads/banner2.jpg" /></div>
				<div style="height:160px;"><img class="image" src="http://cnf.mideoshow.com/uploads/banner3.jpg" /></div>
				<div style="height:160px;"><img class="image" src="http://cnf.mideoshow.com/uploads/banner4.jpg" /></div>
				<div style="height:160px;"><img class="image" src="http://cnf.mideoshow.com/uploads/banner5.jpg" /></div>		  
			  </div>
		</div>
		<div class="header-nav">
			<div class="header-tab-menu mdui-tab mdui-tab-centered">
				<a href="/backhistory.html" class="active mdui-ripple-white">å›æœ›äº”å¹´</a>
				<a href="/say.html" class=" mdui-ripple-white">éƒ½æ¥è¯´è¯´</a>
			</div>
		</div>
	</div>
<div class="loading">
	<div class="circle-one"></div>
	<div class="circle-two"></div>
</div>
<div class="container">
    <div class="grid grid--type-c">
		<div class="grid__sizer"></div>
		{volist name="list" id="vo"}
		<div class="grid__item">
			<div>
			   <a class="grid__link" href="javascript:;">
			     <img class="grid__img" src="{$vo.thumb}" alt="{$vo.descript}" />
			     <span style="position:absolute;right:1px;top:3px;padding:2px 10px;" ><i class="fa fa-image"></i> {$vo.num}</span>
			   </a>
			   <ul class="views_show">
					{volist name="vo['list']" id="vv"}
					<img src="{$vv}" alt="{$vo.descript}">
                    {/volist}					
				</ul>
			 </div>
			<div class="description"><div class="name">{$vo.descript}</div></div>
			<div class="options" style="float:right;"><a href="javascript:void(0)" data-id="{$vo.id}" class="fabulous"><i class="fa fa-thumbs-o-up"></i><span class="like">{$vo.like}</span></a></div>
		</div>
		{/volist}
	</div>
	<div class="big_img">
	<div class="swiper-container2 swiper-container-horizontal">
	<div class="swiper-wrapper">
	</div>
	</div>
	<div class="swiper-pagination2 swiper-pagination-bullets"><span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span></div>
	</div>
</div>	
<div class="container-pages mdui-center" style="padding:10px;text-align:center;color:#ccc;"></div>
<a href="/addpost" class="OpenInAppButton OpenInApp is-shown">è®°å½•ä¸€åˆ»</a>
</div>
</div>
</body>
  <!-- import Vue before Element -->
  <script src="/static/js/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="/static/index/swiper.min.js"></script>
  <script src="/static/index/pike.min.js"></script>
  <script src="/static/index/js/imagesloaded.pkgd.min.js"></script>
	<script src="/static/index/js/masonry.pkgd.min.js"></script>
	<script src="/static/index/js/anime.min.js"></script>
	<script src="/static/index/js/main.js"></script>
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js"></script>
  <script>
    $(function(){
	  $('#app').on('click','.fabulous',function(){
		 clickzan($(this))
	  })
	   	  
	  var mySwiper = new Swiper('.swiper-container2', {
        loop: false,
        pagination: '.swiper-pagination2',
        })
		var myPi = new Pike("#slides", {
	       	type: 1, // è½®æ’­çš„ç±»å‹(1æ¸éš)
	       	automatic: true, //æ˜¯å¦è‡ªåŠ¨è½®æ’­ (é»˜è®¤false)
	       	autoplay: 3000, //è‡ªåŠ¨è½®æ’­æ¯«ç§’ (é»˜è®¤3000)
	       	hover: true, //é¼ æ ‡æ‚¬åœè½®æ’­ (é»˜è®¤false)
	       	arrowColor: "yellow", //ç®­å¤´é¢œè‰² (é»˜è®¤ç»¿è‰²)
	       	arrowBackgroundType: 2, //ç®­å¤´èƒŒæ™¯ç±»å‹ (1: æ–¹å½¢, 2:åœ†å½¢)
	       	arrowBackground: 1, //ç®­å¤´èƒŒæ™¯è‰² (1:ç™½è‰²,2:é»‘è‰², é»˜è®¤:æ— é¢œè‰²)
	       	arrowTransparent: 0.2, //ç®­å¤´èƒŒæ™¯é€æ˜åº¦ (é»˜è®¤: 0.5)
       		spotColor: "white",//åœ†ç‚¹é¢œè‰² (é»˜è®¤: ç™½è‰²)
       		spotType: 1, //åœ†ç‚¹çš„å½¢çŠ¶ (é»˜è®¤: åœ†å½¢, 1:åœ†å½¢, 2.çŸ©å½¢)
       		spotSelectColor: "red", //åœ†ç‚¹é€‰ä¸­é¢œè‰² (é»˜è®¤ç»¿è‰²)
       		spotTransparent: 0.8, //åœ†ç‚¹é€æ˜åº¦ (é»˜è®¤0.8)
       		mousewheel: true, //æ˜¯å¦å¼€å¯é¼ æ ‡æ»šåŠ¨è½®æ’­(é»˜è®¤false)
       		drag: false, //æ˜¯å¦å¼€å¯é¼ æ ‡æ‹–åŠ¨ (é»˜è®¤ä¸º: true, å¦‚ä¸éœ€è¦æ‹–åŠ¨è®¾ç½®falseå³å¯)
       		loop: true, //æ˜¯å¦å¾ªç¯è½®æ’­ (é»˜è®¤ä¸º: false)
       });
		
		$("#app").on("click", ".grid__img", function() {
			var imgBox = $(this).parents(".grid__item").find(".views_show img");
			var i = $(imgBox).index(this);
			$(".big_img .swiper-wrapper").html("")
			for(var j = 0 ,c = imgBox.length; j < c ;j++){
			  $(".big_img .swiper-wrapper").append('<div class="swiper-slide"><div class="cell"><img src="' + imgBox.eq(j).attr("src") + '" / ></div></div>');
			}
			mySwiper.updateSlidesSize();
			mySwiper.updatePagination();
			$(".big_img").css({
				"z-index": 1001,
				"opacity": "1"
			});
			mySwiper.slideTo(i, 0, false);
			return false;
      });
	  
	  $(".big_img").on("click", 
    function() {
        $(this).css({
            "z-index": "-1",
            "opacity": "0"
        });
     });
	})
	
	var loadState = 0, page = 2,isload =true
	function clickzan(obj){
	   var _that = obj
	       id = _that.attr("data-id");
	       num = _that.find('.like').text()
	       newnum=parseInt(num)+1;
	   if(!$.cookie('userid'+id)){
            $.post("/like",{id:id},function(data){
                if(data=='ok'){
                    $.cookie('userid'+id,id);
                    _that.find(".like").text(newnum);
                }
            }); 
        }
        return false;
	}
	$(window).scroll(function () {
	  var scrollTop = $(window).scrollTop(),
		windowHeight = $(window).height(),
		scrollHeight = $('body')[0].scrollHeight;
	  if (scrollTop + windowHeight === scrollHeight) {
		 getMore()
	  }
	  //if (scrollTop > $('.header').height()) {
		//$('.header').removeClass('header-normal-250 header-normal-50 header-normal-170').addClass('header-float mdui-shadow-10');
	  //}
	  //if (0 === scrollTop) {
      // $('.header').removeClass('header-float mdui-shadow-10').addClass('header-normal-' + $('.header').height());
      //}
	});
	
	 function getMore() {
    if (loadState==0 && isload) {
      $.ajax({
        url: '/loadmore',
        data: {page: page},
        type: 'POST',
        dataType: 'JSON',
        beforeSend: function () {
          loadState = 1;
          $(".mdui-center").text("åŠ è½½æ•°æ®ä¸­...")		  
        },
        success: function (res) {

		  if (res!="empty") {
		     page++;
			 loadState = 0
			 $(".mdui-center").text("")
            $('.container .grid').append(res);
          }else{
		    isload = false
			$(".mdui-center").text("å·²ç»åˆ°åº•å•¦")
		  }
        },
        error: function (xhr) {
          //
		  $(".mdui-center").text("å·²ç»åˆ°åº•å•¦")
        }
      });
    }
  }
  </script>
</html>