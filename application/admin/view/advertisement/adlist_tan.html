<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{$app_name}--GAME BRAIN</title>
	{include file="./static/html/header_common.html" /}	
    <style>
	
	
.date-picker {
    cursor: pointer;
	float:right;
	padding-right:20px;
	color: #999;
}
.edit,.delete,.rr{
   cursor: pointer;
}
form .row{
  margin-left:30px;
  margin-bottom:0px;
  margin-right:30px;
  margin-top:5px;
}
.row .col.s6 {
    width: 100%;
    margin-left: auto;
    left: auto;
    right: auto;
}
.row input{
  margin:0 0;
  padding:0 0;
}
.form-control{
   text-indent:10px;
}
.alert {
    padding: 0px;
    margin-bottom: 0px;
    border: 1px solid transparent;
        border-top-color: transparent;
        border-right-color: transparent;
        border-bottom-color: transparent;
        border-left-color: transparent;
    border-radius: 4px;
}
.table-responsive .table > tbody > tr > td {
    border-top: 1px solid #ebedf2 !important;
	padding:5px 0px !important;
	font-size:11px;
}
.table-responsive .table > thead > tr > th{
  border-bottom: 1px solid #ebedf2 !important;
}
.dropdown-menu{right:0px !important;left:-160px;z-index:99999;top:-100px;}
	</style>	
</head>
<body>
    <div id="wrapper" style="background-color: #fff;">
	{include file="./static/html/header.html" /} 
       <div class="hw_page_content">
		    <div class="hw_menu_left">
         {include file="./static/html/side.html" /}  
			</div>
		    <div class="hw_content_right">	
			  <ul class="search_tab clearfix" >
			       <li><a  href="/admin_advertisement/adlist?type=1&id={$appid}">广告ID</a></li>
				   <li {if condition="$isnew eq 0"} class="active" {/if}><a  href="/admin_advertisement/adlist?type=2&id={$appid}">广告参数</a></li>
				   <li {if condition="$isnew eq 1"} class="active" {/if}><a  href="/admin_advertisement/adlist?type=2&id={$appid}&isnew=1">混合参数</a></li>
				   <li><a  href="/admin_advertisement/adshow?appid={$appid}">内推展示</a></li>
                  <li style="float:right;margin-right:60px;" >				  
				   <a class="btn" id="add" style="background-color:#2AB3E9;margin-top:15px;width:100px;height:35px;color:#fff;line-height:20px;" href="javascript:;"><i class="fa fa-plus-circle"></i> 配置</a>				   
				  </li>				  
		       </ul>
			    <div class="table-responsive" style="padding:0 30px;background-color:#fff;border-radius:10px;">
                                <table class="table">
                                    <thead>
                                        <tr>
                                             <th style="vertical-align:middle; text-align:center;">序号</th>
                                             <th style="vertical-align:middle; text-align:center;">字段名称</th>
                                             <th style="vertical-align:middle; text-align:center;">字段值</th>											
                                             <th style="vertical-align:middle; text-align:center;">备注</th>									       
											 <th style="vertical-align:middle; text-align:center;">修改人</th>
									         <th style="vertical-align:middle; text-align:center;">修改时间</th>
											 <th style="vertical-align:middle; text-align:center;">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
									    {volist name="list" id="item"}
                                        <tr class="dt" onclick="he_location({$item.id});">
                                            <td class="dd" style="vertical-align:middle; text-align:center;"><?php $p=isset($_GET["page"])?$_GET["page"]:1; echo ($p-1)*20+$key+1; ?></td>
                                           
                                             <td class="dd" style="vertical-align:middle; text-align:center;">{$item.name}</td>
                                             <td class="dd" style="vertical-align:middle; text-align:center;">{$item.val}{$item.unit}</td>
											 
											
                                          
											 <td class="dd" style="vertical-align:middle; text-align:center;font-style:italic;"><span style="font-size:10px;">{$item.desc}</span></td>
											 <td class="dd" style="vertical-align:middle; text-align:center;">{$item.updateuser}</td>
											 <td class="dd" style="vertical-align:middle; text-align:center;font-style:italic;">{$item.updatetime|getadvertime}</td>
											 <td style="vertical-align:middle; text-align:center;" >
											  
											  <div class="btn-group">
												  <a  class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
													<i class="fa fa-ellipsis-v"></i>
												  </a>
												  <ul class="dropdown-menu">
												  {if condition="($item.name neq 'upltv_switch_on') or (  ($item.name eq 'upltv_switch_on') and ($ad_role eq '6') )"}														
														  <li><a class="edit" data-id="{$item.id}" data-name="{$item.name}" data-val="{$item.val}" data-desc="{$item.desc}">修改</a></li>
                                                          <li><a data-id="{$item.id}" class="delete" >删除</a></li>																																					
											        {/if}
													<li><a href="/admin_advertisement/adparamcountry?id={$item.id}" >国家</a></li>
												  </ul>
												</div>                                               
											 </td>                                           
                                        </tr>
                                        {/volist}
                                    </tbody>
                                </table>
                                 <div>{$list->render()}</div>								
                            </div>
			 </div> 
        </div>
      {include file="./static/html/footer.html" /}		
    </div>
	  {include file="./static/html/footer_common.html" /}
    <script>
	  $(function () {
	  
	       $(".delete").click( function(event){
		        var id = $(this).attr("data-id");
				var _$ = $(this);
		        layer.confirm('确认删除后数据将不会保存?', {
					  btn: ['确认','取消'] //按钮
					}, function(){
					  var index = layer.load(1, {
								  shade: [0.1,'#fff'] //0.1透明度的白色背景
								});
					   $.post("/admin_advertisement/ad_delete",{id:id},function(e){
					       layer.closeAll();
					         if("ok"==e)
							 {
							    _$.parents("tr").remove();
								layer.msg('删除成功');								
							 }else{
							   layer.msg('网络异常,删除失败', {icon: 1});
							 }
					   })
					 
					}, function(){
					  
					});
			   return false;
		   });
		   
		   $("#add").bind('click',function(){
		    
	    var html='<form  style="text-align:center;">';
		    html+=' <div class="row"><p style="font-weight:bold;color:#333;">字段名称<i style="color:red;font-size:10px;">*</i></p><div class="input-field col s6"><input  id="name" name="username" value="" type="text" class="form-control validate"></div></div>';
			html+='<div class="row"><p style="font-weight:bold;color:#333;">字段值<i style="color:red;font-size:10px;">*</i></p><div class="input-field col s6"><input id="val" name="describe" type="text" value="" class="form-control validate"></div></div>';
		   html+='<div class="row"><p style="font-weight:bold;color:#333;">备注</p><div class="input-field col s6"><input name="describe" type="text" value="" id="desc" class="form-control validate"></div></div>';	
			html+='<input class="waves-effect waves-light btn add" type="submit" style="background-color: #ed4040;margin-top:20px;width:140px;" value="增加"></input></form>';
			 //自定页
			layer.open({
			  type: 1,
			  skin: 'layui-layer-rim', //加上边框
			  area: ['500px', '400px'], //宽高
			  content: html
			});
			$(".add").click( function(){
			  
			       var name = $("#name").val();
				   var val = $("#val").val();
				   var desc = $("#desc").val();
				 
				    if( name=="" ||  val=="" )
				   {
				      layer.msg('字段名称,字段值不能为空');
					  return false;
				   }
				   
				   var appid = '<?php echo $appid; ?>';
				   var isnew = '<?php echo $isnew; ?>';
				   layer.load(0, {shade: false});
				   $(this).attr("disabled",true);
			   $.post("/admin_advertisement/ad_add",{name:name,val:val,desc:desc,appid:appid,app_class:2,isnew:isnew},function(e){
			       $(".add").attr("disabled",false);
			      if("ok"==e)
				     {					    
						
						window.location.reload();
						layer.closeAll();
					 }else{
					   layer.msg('添加失败');
					 }
			   })
			  
			   return false;
			})
	    event.stopPropagation();
	});
		   
		});
       				
	   $(".edit").click( function(event){
	    var _$ = $(this);
		var id = _$.attr("data-id");
		var name = _$.attr("data-name");
		var val = _$.attr("data-val");
		var desc = _$.attr("data-desc");
		
	    var html='<form  style="text-align:center;">';
		    html+=' <div class="row"><p style="font-weight:bold;color:#333;">字段名称</p><div class="input-field col s6"><input  id="name" name="username" value="'+name+'" type="text" class="form-control validate"></div></div>';
			html+='<div class="row"><p style="font-weight:bold;color:#333;">字段值</p><div class="input-field col s6"><input  id="val" name="describe" type="text" value="'+val+'" class="form-control validate"></div></div>';
			
			html+='<div class="row"><p style="font-weight:bold;color:#333;">备注</p><div class="input-field col s6"><input name="describe" type="text" value="'+desc+'" id="desc" class="form-control validate"></div></div>';
			
			html+='<input class="waves-effect waves-light btn save" type="submit" style="background-color: #2ec376;margin-top:20px;width:140px;" value="修改"></input> </form>';
	   
		    //自定页
			layer.open({
			  type: 1,
			  skin: 'layui-layer-rim', //加上边框
			  area: ['550px', '400px'], //宽高
			  content: html
			});
			$(".save").click( function(){
			  
			       name = $("#name").val();
				   val = $("#val").val();
				   desc = $("#desc").val();
				 
				    if( name=="" ||  val=="" )
				   {
				      layer.msg('字段名称,字段值不能为空');
					  return false;
				   }
				   layer.load(0, {shade: false});
				   $(this).attr("disabled",true);
			   $.post("/admin_advertisement/ad_edit",{id:id,name:name,val:val,desc:desc},function(e){
			       $(".save").attr("disabled",false);
			      if("ok"==e)
				     {					    
						
						window.location.reload();
						layer.closeAll();
					 }else{
					   layer.msg('修改失败');
					 }
			   })
			  
			   return false;
			})
	    event.stopPropagation();
	});	
	
	
	</script>
</body>

</html>
