<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GameBrain</title>
	{include file="./static/html/header_common.html" /}	
    <style>
	
	
.date-picker {
    cursor: pointer;
	float:right;
	padding-right:20px;
	color: #999;
}
.edit,.delete,.rr{
   cursor: pointer;
}
form .row{
  margin-left:30px;
  margin-bottom:0px;
  margin-right:30px;
  margin-top:5px;
}
.row .col.s6 {
    width: 100%;
    margin-left: auto;
    left: auto;
    right: auto;
}
.row input{
  margin:0 0;
  padding:0 0;
}
.form-control{
   text-indent:2px;
}
.alert {
    padding: 0px;
    margin-bottom: 0px;
    border: 1px solid transparent;
        border-top-color: transparent;
        border-right-color: transparent;
        border-bottom-color: transparent;
        border-left-color: transparent;
    border-radius: 4px;
}
	</style>	
</head>
<body>
    <div id="wrapper" style="background-color:#fff;">
	{include file="./static/html/header.html" /} 
       <div class="hw_page_content">
		    <div class="hw_menu_left">
         {include file="./static/html/side.html" /}  
			</div>
		    <div class="hw_content_right">	
			  <ul class="search_tab clearfix" >
			     <li><a  href="javascript:;" onclick="window.history.go(-1);">返回</a></li>
			       <li class="active"><a  href="javascript:;">国家参数</a></li>
                  <li style="float:right;margin-right:60px;" >				   
				     {if condition="($name neq 'upltv_switch_on') or (  ($name eq 'upltv_switch_on') and ($userid eq '6') )"}
				      <a class="btn" id="add" style="background-color:#2AB3E9;margin-top:15px;width:100px;height:35px;color:#fff;line-height:20px;" href="javascript:;"><i class="fa fa-plus-circle"></i> 国家</a>
				     {/if}				   
				  </li>				  
		       </ul>
			    <div class="table-responsive" style="padding:0 30px;">
                                <table class="table">
                                    <thead>
                                        <tr>
                                             <th style="vertical-align:middle; text-align:center;">序号</th>
                                             <th style="vertical-align:middle; text-align:center;">字段名称</th>
                                             <th style="vertical-align:middle; text-align:center;">字段值</th>
											
                                             <th style="vertical-align:middle; text-align:center;">国家</th>
									       
											
											 <th style="vertical-align:middle; text-align:center;">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
									    {volist name="list" id="item"}
                                        <tr class="dt" onclick="he_location({$item.id});">
                                            <td class="dd" style="vertical-align:middle; text-align:center;"><?php $p=isset($_GET["page"])?$_GET["page"]:1; echo ($p-1)*20+$key+1; ?></td>
                                           
                                             <td class="dd" style="vertical-align:middle; text-align:center;">{$item.name}</td>
                                             <td class="dd" style="vertical-align:middle; text-align:center;">{$item.prop_value_two}</td>                                   
											 <td class="dd" style="vertical-align:middle; text-align:center;font-style:italic;"><?php echo $admincountry[$item["prop_value_one"]]; ?></td>											
											 <td style="vertical-align:middle; text-align:center;" >
                                              {if condition="($name neq 'upltv_switch_on') or (  ($name eq 'upltv_switch_on') and ($userid eq '6') )"}											 
											  <div class="btn-group">
												  <a  class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
													<i class="fa fa-ellipsis-v"></i>
												  </a>
												  <ul class="dropdown-menu">												  
														<li><a class="edit" data-id="{$item.pid}" data-name="{$item.name}" data-val="{$item.prop_value_two}" data-code-name="<?php echo $admincountry[$item["prop_value_one"]]; ?>" data-code="{$item.prop_value_one}">修改</a></li>
														<li><a data-id="{$item.pid}" class="delete" >删除</a></li>												
												  </ul>
												</div>											 
											   {/if}
											 </td>                                           
                                        </tr>
                                        {/volist}
                                    </tbody>
                                </table>
                                 							
                            </div>
			 </div> 
        </div>
      {include file="./static/html/footer.html" /}		
    </div>
	  {include file="./static/html/footer_common.html" /}
    <script>
	  $(function () {
	  
	       $(".delete").click( function(event){
		        var id = $(this).attr("data-id");
				var _$ = $(this);
		        layer.confirm('确认删除后数据将不会保存?', {
					  btn: ['确认','取消'] //按钮
					}, function(){
					  var index = layer.load(1, {
								  shade: [0.1,'#fff'] //0.1透明度的白色背景
								});
					   $.post("/admin_advertisement/country_delete",{id:id},function(e){
					       layer.closeAll();
					         if("ok"==e)
							 {
							    _$.parents("tr").remove();
								layer.msg('删除成功');								
							 }else{
							   layer.msg('网络异常,删除失败', {icon: 1});
							 }
					   })
					 
					}, function(){
					  
					});
			   return false;
		   });
		   
		   $("#add").bind('click',function(){
		    
	    var html='<form  style="text-align:center;">';
		    html+=' <div class="row"><p style="font-weight:bold;color:#333;">字段名称<i style="color:red;font-size:10px;">*</i></p><div class="input-field col s6"><input  id="name" name="username" value="{$name}" disabled type="text" class="form-control validate"></div></div>';
			html+='<div class="row"><p style="font-weight:bold;color:#333;">国家<i style="color:red;font-size:10px;">*</i></p><div class="input-field col s6">';
			html+='<select class="form-control" id=aaxx name="prop_value_one">';
			html+='<option value="country">请选择国家</option>';
			html+='<option  value="US">美国</option>';
			html+='<option  value="TW">台湾</option>';
			html+='<option  value="HK">香港</option>';
			html+='<option value="JP">日本</option>';
			html+='<option  value="KR">韩国</option>';
			html+='<option  value="DE">德国</option>';
			html+='<option  value="FR">法国</option>';
			html+='<option  value="CN">中国</option>';
			html+='<option  value="RU">俄罗斯</option>';
			html+='<option  value="CA">加拿大</option>';
			html+='<option  value="GB">英国</option>';
			html+='<option  value="ID">印度尼西亚</option>';
			html+='<option  value="TH">泰国</option>';
			html+='<option  value="BR">巴西</option>';
			html+='<option  value="TR">土尔其</option>';
			html+='<option  value="VN">越南</option>';
			html+='<option  value="AU">澳大利亚</option>';
			html+='<option  value="MY">马来西亚</option>';
			html+='<option  value="MO">澳门</option>';
			html+='<option  value="SG">新加坡</option>';
			html+='</select></div></div>';
			html+='<div class="row"><p style="font-weight:bold;color:#333;">字段值<i style="color:red;font-size:10px;">*</i></p><div class="input-field col s6"><input id="val" name="describe" type="text" value="" class="form-control validate"></div></div>';
		  
			html+='<input class="waves-effect waves-light btn add" type="submit" style="background-color: #ed4040;margin-top:20px;width:140px;" value="增加"></input></form>';
			 //自定页
			layer.open({
			  type: 1,
			  skin: 'layui-layer-rim', //加上边框
			  area: ['500px', '400px'], //宽高
			  content: html
			});
			$(".add").click( function(){
			  
			       var prop_value_one = $("#aaxx").val();
				   var prop_value_two = $("#val").val();
				   var cfid  ='<?php echo $id ?>'; 
				    if( val=="" )
				   {
				      layer.msg('字段值不能为空');
					  return false;
				   }
				   layer.load(0, {shade: false});
				   $(this).attr("disabled",true);
			   $.post("/admin_advertisement/adparams_add",{prop_value_one:prop_value_one,prop_value_two:prop_value_two,cfid:cfid},function(e){
			       $(".add").attr("disabled",false);
			      if("ok"==e)
				     {					    
						
						window.location.reload();
						layer.closeAll();
					 }else{
					   layer.msg('添加失败');
					 }
			   })
			  
			   return false;
			})
	    event.stopPropagation();
	});
		   
		});
       				
	   $(".edit").click( function(event){
	    var _$ = $(this);
		var id = _$.attr("data-id");
		var name = _$.attr("data-name");
		var val = _$.attr("data-val");
		var code = _$.attr("data-code");
		var code_name =  _$.attr("data-code-name");
	    var html='<form  style="text-align:center;">';
		    html+=' <div class="row"><p style="font-weight:bold;color:#333;">字段名称</p><div class="input-field col s6"><input  id="name" name="username"  disabled value="'+name+'" type="text" class="form-control validate"></div></div>';
			html+='<div class="row"><p style="font-weight:bold;color:#333;">国家<i style="color:red;font-size:10px;">*</i></p><div class="input-field col s6"><input  disabled value="'+code_name+'" type="text" class="form-control validate"></div></div>';
			
			html+='<div class="row"><p style="font-weight:bold;color:#333;">字段值</p><div class="input-field col s6"><input id="val" name="describe" type="text" value="'+val+'" class="form-control validate"></div></div>';			
			html+='<input class="waves-effect waves-light btn save" type="submit" style="background-color: #2ec376;margin-top:20px;width:140px;" value="修改"></input> </form>';
	   
		    //自定页
			layer.open({
			  type: 1,
			  skin: 'layui-layer-rim', //加上边框
			  area: ['550px', '400px'], //宽高
			  content: html
			});
			
			$(".save").click( function(){
			  
                  val = $("#val").val();
				  
				    if( val=="" )
				   {
				      layer.msg('字段名称,字段值不能为空');
					  return false;
				   }
				   layer.load(0, {shade: false});
				   $(this).attr("disabled",true);
			   $.post("/admin_advertisement/adparams_edit",{id:id,val:val},function(e){
			       $(".save").attr("disabled",false);
			      if("ok"==e)
				     {					    						
						window.location.reload();
						layer.closeAll();
					 }else{
					   layer.msg('修改失败');
					 }
			   })
			  
			   return false;
			})
	    event.stopPropagation();
	});	
	
	
	</script>
</body>

</html>
