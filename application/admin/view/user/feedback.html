<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GAME BRAIN</title>
    {include file="./static/html/header_common.html" /}
  
<link href="/static/css/froala_editor.min.css" rel="stylesheet" type="text/css">	
	<style>
	th,td{text-align:center;vertical-align:middle}
	  .hw_reven thead tr {
	  background-color: #f9f9f9;
	  color:#333;
}
.table > thead > tr > th{
  border-bottom: 1px solid #ddd !important;
}
.col-lg-6 {
    width: 25%;
}
.user-info {
    overflow: hidden;
    height: 220px;
    position: relative;
    margin: 0 7px 14px;
    padding: 25px 10px 0;
    -webkit-box-shadow: 0 0 3px #f1f1f1;
    -moz-box-shadow: 0 0 3px #f1f1f1;
    box-shadow: 0 0 3px #f1f1f1;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    -webkit-transition: -webkit-box-shadow .3s;
    transition: -webkit-box-shadow .3s;
    -moz-transition: box-shadow .3s,-moz-box-shadow .3s;
    transition: box-shadow .3s;
    transition: box-shadow .3s,-webkit-box-shadow .3s,-moz-box-shadow .3s;
}
.user-info .user-img {
    text-align: center;
    height: 84px;
    display: block;
}
.user-img img {
    width: 84px;
    height: 84px;
    -webkit-border-radius: 50%;
    -moz-border-radius: 50%;
    border-radius: 50%;
}
.user-info .user-name {
    line-height: 30px;
    padding-top: 10px;

    text-align: center;
    font-size: 14px;
    color: #555;
    width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.user-info .user-follow {
    text-align: center;
	margin:12px 0px;
}
.user-info .user-follow a {
    cursor: pointer;
    color: #f85959;
    font-size: 13px;
    padding: 5px 10px;
    border: 1px solid #f85959;
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    border-radius: 2px;
    -webkit-transition: all .3s;
    -moz-transition: all .3s;
    transition: all .3s;
}
.user-info:hover {
    -webkit-box-shadow: 0 0 7px #999;
    -moz-box-shadow: 0 0 7px #999;
    box-shadow: 0 0 7px #999;
}
.sendmessage{
 position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    height: 100%;
    overflow-y: auto;
	
}
.hw_game-dialog {
    position: relative;
    width: 60%;
    background: #fff !important;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    -webkit-box-shadow: 0 0 5px #333;
    -moz-box-shadow: 0 0 5px #333;
    box-shadow: 0 0 5px #333;
    margin: 0 auto 40px;
    overflow: hidden;
    top: 80px;
    z-index: 1002;
}
.hw_modal {
    z-index: 1000;
    position: fixed;
    top: 0;
    bottom: 0;
    width: 100%;
    opacity: .5;
    background: #333;
}
.mTips{right:0px;top:0px;max-width:100% !important;}
	</style>
</head>
<body>
    <div id="wrapper" style="background-color: #fff;">
        {include file="./static/html/header.html" /}	
		<div class="hw_page_content">
		    <div class="hw_menu_left">
         {include file="./static/html/side.html" /}  
			</div>
		    <div class="hw_content_right" style="padding:10px 10px;">
			    <ul class="search_tab clearfix" >
				  {if condition="getuserrole() eq 'super'"}
			       <li><a href="/admin_user/userlist">用户列表</a></li>
				  {/if}
				  <li class="active"><a  href="javascript:;">用户反馈</a></li>
				  {if condition="getuserrole() eq 'super'"}
				    <li><a  href="/admin_profile/rule">用户权限</a></li>
                  {/if}				  
		        </ul>
			    <div class="hw_reven clearfix" style="padding:20px 0px;">
			      <table class="table table-hover" >
							  <thead style="font-size:13px;">
								<tr>
								   <th style="text-align:left;width:100px">用户名</th>
								   <th style="text-align:left;">描述</th>								  
								   <th style="text-align:left;">截图</th>								   
								   <th style="text-align:left;">状态</th>
								   <th style="text-align:left;">反馈时间</th>
								   <th style="text-align:left;">系统备注</th>
								</tr>
							  </thead>
							  <tbody>
							    {volist name="data" id="vv"}
								<tr>
								   <td style="text-align:left;width:100px;color:#333;">{$vv.userid|getusername}</td>
								  <td style="text-align:left;font-size:12px;width:40%;">{$vv.desc}</td>
								  <td style="text-align:left;">
								    <a style="cursor:pointer;" target="__blank" href="{$vv.url}"><img style="width:40px;height:40px;"src="{$vv.url}" /></a>
								   
								  </td>
								  <td style="text-align:left;font-size:12px;">
								   {if condition="$vv['status'] eq 0"}
								   <span style="color:red">待处理</span>
								   {else /}
								   <span style="color:green">已处理</span>
								   {/if}
								  </td>
								  <td style="text-align:left;font-size:12px;">{$vv.create_time}</td>
                                  <td style="text-align:left;color:red;font-size:12px;">{$vv.remark}</td>								  
								</tr>
								{/volist}								
							  </tbody>
				  </table>
				  <div style="text-align:center;">{$data->render()}</div>
				</div>
			</div>
			
			 
		</div>
		 {include file="./static/html/footer.html" /}
	</div>	
</body>
 {include file="./static/html/footer_common.html" /}
 <script type="text/javascript" src="/static/js/jquery-1.11.1.min.js"></script>
 <script src="/static/js/froala_editor.min.js"></script>
  <!--[if lt IE 9]>
    <script src="/static/js/froala_editor_ie8.min.js"></script>
  <![endif]-->
    <script src="/static/plugin/froala/tables.min.js"></script>
	  <script src="/static/js/mTips.js"></script>
  <script src="/static/plugin/froala/lists.min.js"></script>
  <script src="/static/plugin/froala/colors.min.js"></script>
  <script src="/static/plugin/froala/media_manager.min.js"></script>
  <script src="/static/plugin/froala/font_family.min.js"></script>
  <script src="/static/plugin/froala/font_size.min.js"></script>
  <script src="/static/plugin/froala/block_styles.min.js"></script>
  <script src="/static/plugin/froala/video.min.js"></script>
 <script>
    $(function(){
	    $(".primary").click( function(){
		   var touserid =$(this).attr("data_userid");
		   $(".name").text($(this).attr("data_truename"));		   
		   $(".sendmessage").show();
           $('div.froala-element').html("");		   
		   add_message(touserid);
		})
		$(".delete").click(function(){
		  let userid = $(this).attr('data-id')
		  layer.confirm('是否确定要删除该用户？', {
			  btn: ['确认','否'] //按钮
			}, function(){
			  $.post("/admin_user/del_user",{id:userid,},function(e){
					
					if( "ok"==e )
					  {						
						layer.msg('删除成功!');	
                        window.location.reload()						
					  }else{
						layer.msg('删除失败');
					  }			
				})
			}, function(){
			  
			});
		})
		$("#cancel").click( function(){
		   $('div.froala-element').html("");
		   $(".sendmessage").hide();
		})
	  $('#edit').editable({	
		  inlineMode: false,		
		  width:'100%',
		  height: '200px' //高度		  
		  })          
	})
  var add_message=function(touserid){
  
     $("#save").click( function(){
		    
			   var title = $("#title").val();
			  
			   var content = $('div.froala-element').html();
			   			   
			   if( title.length<2  ||  title.length>30  )
				{
					layer.msg('标题长度2-30个字符内!');return false;
				}
				
				if(  content.length<2  )
				{
					layer.msg('内容描述至少2个字符以上!');return false;
				}
				
				$(this).attr("disabled",true);
				var obj = $(this);
				var index = layer.load(0, {shade: false}); //0代表加载的风格，支持0-2
				$.post("/message/add_message",{title:title,content:content,touserid:touserid},function(e){
					layer.close(index);
					
					$(obj).attr("disabled",false);
					if( "ok"==e )
					  {
						$('div.froala-element').html("");
		                $(".sendmessage").hide();
						layer.msg('私信已发送到对方');
						
					  }else{
						layer.msg('由于异常，发送失败');return false;
					  }			
				})
			});
  }	
 </script>
</html>